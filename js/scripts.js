!function(a,b){"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module&&module.exports?module.exports=b():a.lscache=b()}(this,function(){function a(){var a="__lscachetest__",c=a;if(void 0!==n)return n;try{h(a,c),i(a),n=!0}catch(a){n=!!b(a)}return n}function b(a){return!!(a&&"QUOTA_EXCEEDED_ERR"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name||"QuotaExceededError"===a.name)}function c(){return void 0===o&&(o=null!=window.JSON),o}function d(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");
}function e(a){return a+q}function f(){return Math.floor((new Date).getTime()/s)}function g(a){return localStorage.getItem(p+u+a)}function h(a,b){localStorage.removeItem(p+u+a),localStorage.setItem(p+u+a,b)}function i(a){localStorage.removeItem(p+u+a)}function j(a){for(var b=new RegExp("^"+p+d(u)+"(.*)"),c=localStorage.length-1;c>=0;--c){var f=localStorage.key(c);f=f&&f.match(b),f=f&&f[1],f&&f.indexOf(q)<0&&a(f,e(f))}}function k(a){var b=e(a);i(a),i(b)}function l(a){var b=e(a),c=g(b);if(c){var d=parseInt(c,r);
if(f()>=d)return i(a),i(b),!0}}function m(a,b){v&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+a),b&&window.console.warn("lscache - The error was: "+b.message))}var n,o,p="lscache-",q="-cacheexpiration",r=10,s=6e4,t=Math.floor(864e13/s),u="",v=!1,w={set:function(d,l,n){if(a()){if("string"!=typeof l){if(!c())return;try{l=JSON.stringify(l)}catch(a){return}}try{h(d,l)}catch(a){if(!b(a))return void m("Could not add item with key '"+d+"'",a);var o,p=[];j(function(a,b){
var c=g(b);c=c?parseInt(c,r):t,p.push({key:a,size:(g(a)||"").length,expiration:c})}),p.sort(function(a,b){return b.expiration-a.expiration});for(var q=(l||"").length;p.length&&q>0;)o=p.pop(),m("Cache is full, removing item with key '"+d+"'"),k(o.key),q-=o.size;try{h(d,l)}catch(a){return void m("Could not add item with key '"+d+"', perhaps it's too big?",a)}}n?h(e(d),(f()+n).toString(r)):i(e(d))}},get:function(b){if(!a())return null;if(l(b))return null;var d=g(b);if(!d||!c())return d;try{return JSON.parse(d);
}catch(a){return d}},remove:function(b){a()&&k(b)},supported:function(){return a()},flush:function(){a()&&j(function(a){k(a)})},flushExpired:function(){a()&&j(function(a){l(a)})},setBucket:function(a){u=a},resetBucket:function(){u=""},enableWarnings:function(a){v=a}};return w}),function(){function a(a){function d(){for(;h=k<j.length&&a>l;){var b=k++,d=j[b],f=c.call(d,1);f.push(e(b)),++l,d[0].apply(null,f)}}function e(a){return function(b,c){--l,null==n&&(null!=b?(n=b,k=m=NaN,f()):(j[a]=c,--m?h||d():f()));
}}function f(){null!=n?o(n):i?o(n,j):o.apply(null,[n].concat(j))}var g,h,i,j=[],k=0,l=0,m=0,n=null,o=b;return a||(a=1/0),g={defer:function(){return n||(j.push(arguments),++m,d()),g},await:function(a){return o=a,i=!1,m||f(),g},awaitAll:function(a){return o=a,i=!0,m||f(),g}}}function b(){}var c=[].slice;a.version="1.0.7","function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:this.queue=a}(),function(a){var b=[],c=function(){},d={defaultPath:"/",
before:c,on:c,notfound:c},e={current:null,previous:null,config:function(a){for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b]);return e},add:function(a,c,d){return a&&c&&("function"==typeof c&&(d=c,c=null),b.push({path:a,name:c,fn:d||function(){}})),e},go:function(a){return location.hash=a,e},back:function(a){return e.previous?(history.back(),e.previous=null):a&&(location.hash=a),e}},f=function(){var a=location.hash.slice(1),c=!1,f=e.current;a||(a=d.defaultPath),f&&f!=e.previous&&(e.previous=f),e.current=a;
for(var g=0,h=b.length;h>g&&!c;g++){var i=b[g],j=i.path,k=i.name,l=i.fn;if("string"==typeof j)j.toLowerCase()==a.toLowerCase()&&(d.before.call(e,j,k),l.call(e),d.on.call(e,j,k),c=!0);else{var m=a.match(j);m&&(d.before.call(e,j,k,m),l.apply(e,m),d.on.call(e,j,k,m),c=!0)}}return c||d.notfound.call(e),e};e.init=function(b){return a.addEventListener("hashchange",f),f()},e.reload=f,a.ruto=e}(window);var Yokuto=function(){var a=function(a,b){if(!a||1!==a.nodeType)return!1;var c=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.oMatchesSelector||a.msMatchesSelector;
return c.call(a,b)},b=function(b,c){var d=!1;do d=a(b,c);while(!d&&(b=b.parentNode)&&b.ownerDocument);return d?b:!1},c=function(a,b){if(!a)return this;b||(b=document);var c;"string"!=typeof a?(this.selector="",c=[a]):(this.selector=a,c=[].slice.call(b.querySelectorAll(a)));for(var d=this.length=c.length,e=0;d>e;e++)this[e]=c[e];return this};return c.prototype={each:function(a){for(var b=this.length,c=0;b>c;c++){var d=this[c];a.call(d,d,c)}return this},on:function(a,c,d,e){return"string"!=typeof c?(e=d,
d=c,this.each(function(b){a.split(" ").forEach(function(a){b.addEventListener(a,d,e||!1)})})):this.each(function(f){a.split(" ").forEach(function(a){f.addEventListener(a,function(a){var e=b(a.target,c);e&&d.call(e,a)},e||!1)})}),this},trigger:function(a){if(!this.length)return this;var b=this[0],c=document.createEvent("MouseEvents"),d="dblclick"==a?2:1,e="contextmenu"==a?2:0;return c.initEvent(a,!0,!0,document.defaultView,d,0,0,0,0,!1,!1,!1,!1,e,b),b.dispatchEvent(c),this},find:function(a){return new c(a,this[0]);
},parent:function(){var a=this[0];return new c(a.parentElement||a.parentNode)},next:function(){var a=this[0];return new c(a.nextElementSibling||a.nextSibling)},prev:function(){var a=this[0];return new c(a.previousElementSibling||a.previousSibling)},addClass:function(a){return this.each(function(b){b.classList.add(a)}),this},removeClass:function(a){return this.each(function(b){b.classList.remove(a)}),this},toggleClass:function(a){return this.each(function(b){b.classList.toggle(a)}),this},html:function(a){
return this.length?a?(this[0].innerHTML=a,this):this[0].innerHTML:this},attr:function(a){return this.length?this[0].getAttribute(a):""},data:function(a){return this.length?this[0].getAttribute("data-"+a):void 0},text:function(a){if(!this.length)return"";var b=this[0];return a?(b.textContent=a,this):b.textContent},val:function(a){if(!this.length)return"";var b=this[0];return"string"==typeof a?(b.value=a,this):b.value},focus:function(){return this.length&&this[0].focus&&this[0].focus(),this},blur:function(){
return this.length&&this[0].blur&&this[0].blur(),this}},function(a){return new c(a)}}();"$"in window||(window.$=Yokuto),function(){if(window.addEventListener){var a="2",b=lscache.get("busDataVersion");if(a!=b&&localStorage&&localStorage.length&&localStorage.removeItem){for(var c=localStorage.length-1;c>=0;--c){var d=localStorage.key(c);0===d.indexOf("__amplify__bus")&&localStorage.removeItem(d)}lscache.flush(),lscache.set("busDataVersion",a)}var e,f={busStops:"bus-stops.json",busServices:"bus-services.json",
busService:"bus-services/{{no}}.json",busStopsServices:"bus-stops-services.json"},g=function(a,b,c){2==arguments.length&&(c=b,b={});var d=lscache.get(a);if(d)c(null,d);else{var e=new XMLHttpRequest,g="data/2/"+f[a.split("-")[0]];for(p in b)g=g.replace("{{"+p+"}}",b[p]);e.onload=function(){try{var b=JSON.parse(this.responseText);c(null,b),lscache.set(a,b,1440)}catch(a){c(a)}},e.onerror=e.onabort=c,e.open("get",g,!0),e.send()}},h=[function(a){g("busStops",a)},function(a){g("busServices",a)},function(a){
g("busStopsServices",a)},function(a){function b(){var b=new google.maps.LatLng(1.352083,103.819836),c=new google.maps.Map(document.getElementById("map"),{mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,keyboardShortcuts:!0}),d=new google.maps.LatLngBounds(new google.maps.LatLng(1.25352193438281,103.62192147229632),new google.maps.LatLng(1.50129709375363,103.99983438993593));c.fitBounds(d);var f="assets/images/bus-sprite.png",g=new google.maps.Size(78,84);if(e={location:{url:f,scaledSize:g,
size:new google.maps.Size(18,19),anchor:new google.maps.Point(9,9.5),origin:new google.maps.Point(48,0)},circle:{url:f,scaledSize:g,size:new google.maps.Size(18,19),anchor:new google.maps.Point(9,9.5),origin:new google.maps.Point(30,0)},dot:{url:f,scaledSize:g,size:new google.maps.Size(26,38),origin:new google.maps.Point(0,46)},a:{url:f,scaledSize:g,size:new google.maps.Size(26,38),origin:new google.maps.Point(26,46)},b:{url:f,scaledSize:g,size:new google.maps.Size(26,38),origin:new google.maps.Point(52,46)
}},navigator.geolocation){var h=document.getElementById("geolocation-control");c.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(h);var i,j=new google.maps.Marker({map:c,clickable:!1,title:"Current location",icon:e.location,cursor:"default",visible:!1,zIndex:9001}),k=new google.maps.Circle({map:c,clickable:!1,fillColor:"#00b4d2",fillOpacity:.1,strokeWeight:0,visible:!1,zIndex:9e3}),l=!1,m=function(){navigator.geolocation.clearWatch(i),l=!1,k.setVisible(!1),j.setVisible(!1),$("#geolocation-control").removeClass("active");
};$("#map").on("click","#geolocation-control",function(a){if(a.preventDefault(),l){var b=j.getPosition();c.getBounds().contains(b)?m():c.panTo(b)}else{var e=!1;i=navigator.geolocation.watchPosition(function(a){l=!0;var b=a.coords,f=new google.maps.LatLng(b.latitude,b.longitude);if(k.setCenter(f),k.setRadius(b.accuracy),k.setVisible(!0),j.setPosition(f),j.setVisible(!0),!e&&d.contains(f)){c.panTo(f);var g=c.getZoom();15>g&&c.setZoom(15),e=!0}$("#geolocation-control").addClass("active")},function(a){
m(),alert("Unable to get your location. Please try again.")},{enableHighAccuracy:!0,timeout:6e4,maximumAge:5e3})}})}var n=$("#bounds-warning");google.maps.event.addListener(c,"bounds_changed",function(){var a=c.getBounds();a.intersects(d)?n.removeClass("visible"):n.addClass("visible")}),$("#back-sg").on("click",function(a){a.preventDefault(),n.removeClass("visible"),c.panTo(b),setTimeout(function(){c.fitBounds(d)},300)});var o=document.getElementById("header-search");c.controls[google.maps.ControlPosition.RIGHT_TOP].push(o);
var p=$("#places-search-form");p.on("submit",function(a){a.preventDefault()});var q=new google.maps.places.Autocomplete(p.find("input")[0],{bounds:d,componentRestrictions:{country:"sg"}});google.maps.event.addListener(q,"place_changed",function(){$("#search").removeClass("show");var a=q.getPlace();a.geometry&&(a.geometry.viewport?c.fitBounds(a.geometry.viewport):(c.setCenter(a.geometry.location),c.setZoom(17)))}),lscache.get("busrouter-intro")||/\w/i.test(location.hash)||$("#about").addClass("show"),
a(null,c)}queue().defer(function(a){var b=document.createElement("script");b.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDJii3LssFIl3cw4XzTxtWqSls57rayV5I&libraries=places&callback=loadMap",document.body.appendChild(b),window.loadMap=a}).await(b)}],i=function(a,b){var c={},d={};a.services.forEach(function(a){var b=a.type;c[b]?c[b].push(a):c[b]=[a],d[a.no]=a});var e=$("#bus-services"),f='<label class="search-field"><svg class="icon"><use xlink:href="#search-icon"></use></svg><input placeholder="Bus service number e.g.: 133" required><a href="#" class="close"><svg class="icon"><use xlink:href="#times"></use></svg></a></label>';
for(type in c){var g=c[type];f+="<h2>"+a.types[type]+"</h2><ul>";for(var h=0,i=g.length;i>h;h++){var j=g[h],k=j.no;f+=b?'<li><a href="/#/compare/'+k+"/1"+b+'" id="service-'+k+'">'+k+" <span>"+j.name+"</span></a></li>":'<li><a href="#/services/'+k+'" id="service-'+k+'">'+k+" <span>"+j.name+"</span></a></li>"}f+="</ul>"}e.html(f);var l=e.find("input"),m=e.find("li a"),n=function(){var a=l.val();m.each(function(b){var c=b.textContent.trim().toLowerCase(),d=c.indexOf(a.toLowerCase())<0;d?$(b).addClass("hidden"):$(b).removeClass("hidden");
})};return l.on("input",n),e.find(".close").on("click",function(a){a.preventDefault(),l.val(""),n(),l.focus()}),[d,e]},j=function(a,b){if(a||!b||4!=b.length)return void alert("Oops, an error occured.");var c=b[0],d=b[1],f=b[2],h=b[3],j={};c.forEach(function(a){j[a.no]=a});var k=i(d);busServicesMap=k[0],$busServices=k[1];var l,m,n=[],o=[],p={},q=new google.maps.InfoWindow({maxWidth:260}),r=new google.maps.Polyline({clickable:!1,strokeColor:"#f01b48",strokeWeight:5,strokeOpacity:.5}),s=new google.maps.Polyline({
clickable:!1,strokeColor:"#0f34b7",strokeWeight:5,strokeOpacity:.5}),t=function(){n.forEach(function(a){a.setMap(null),google.maps.event.clearInstanceListeners(a)}),n=[],o.forEach(function(a){a.setMap(null),google.maps.event.clearInstanceListeners(a)}),o=[];for(var a in u){var b=u[a];b.setMap(null),google.maps.event.clearInstanceListeners(b)}u={};for(var c in p){var d=p[c];d.setMap(null),google.maps.event.clearInstanceListeners(d)}p={},r.setMap(null),s.setMap(null),q.close()};google.maps.event.addListener(h,"markerClick",function(a){
var b=a.marker,c=a.stop,d=a.currentService,e=a.hideShowRoutesLink,g=j[c],i=g.name,k=f[c],l='<div class="infowindow"><h1>'+i+'&nbsp;<span class="tag">'+c+"</span></h1>";k.forEach(function(a){l+=a==d?'<span class="infoservice">'+a+"</span> ":'<a href="#/services/'+a+'" class="infoservice">'+a+"</a> "}),l+='<div class="infofooter">',l+='<a href="bus-arrival/#'+c+'" target="_blank" class="show-arrivals"><svg class="icon"><use xlink:href="#clock-o"></use></svg> Show bus arrival times here</a>',k.length>1&&!e&&(l+='<a href="#/stops/'+c+'" class="show-routes"><svg class="icon"><use xlink:href="#code-fork"></use></svg> Show all routes passing here</a>'),
l+="</div></div>",q.setContent(l),q.open(h,b)});var u={};google.maps.event.addListener(h,"idle",function(){if("home"==y){var a=$("#bus-stops"),b=h.getZoom();if(b>=15){$("#bus-stops-section").removeClass("hidden");var d=h.getBounds();for(var f in u){var g=u[f];if(!d.contains(g.getPosition())){g.setMap(null),u[f]=void 0;try{delete u[f]}catch(a){}}}var i=[];if(c.forEach(function(a){var b=a.no;if(!u[b]){var c=new google.maps.LatLng(a.lat,a.lng);if(!d.contains(c))return;var f=new google.maps.Marker({position:c,
map:h,title:a.name,icon:e.circle});google.maps.event.addListener(f,"click",function(){google.maps.event.trigger(h,"markerClick",{marker:f,stop:b})}),u[b]=f}i.push({no:b,stop:a})}),i.length){var j="<ul>";i.sort(function(a,b){var c=a.stop.name,d=b.stop.name;return d>c?-1:c>d?1:0}),i.forEach(function(a){var b=a.no,c=a.stop.name;j+='<li><a class="stop" id="stop-'+b+'"><span class="tag">'+b+"</span> "+c+"</a></li>"}),j+="</ul>",a.html(j)}else a.html("<p>Zoom in or pan around to see bus stops on the map.</p>");
}else{for(var f in u)u[f].setMap(null);u=[],a.html("<p>Zoom in or pan around to see bus stops on the map.</p>")}}}),$("#bus-stops").on("click","li a",function(a){a.preventDefault();var b=$(this).find(".tag").text(),c=u[b],d=c.getPosition();h.panTo(d),google.maps.event.trigger(c,"click")}),$("#bus-stops-section").on("click","a.close",function(a){a.preventDefault(),$("#bus-stops-section").addClass("hidden")});var v,w=$("#bus-routes"),x=document.title,y="home",z=function(a,b,c,d){var i=!!d,k=a.split("/");
k[3]=2==c?1:2;var p=k.join("/");if(i){var q=k[4],u=k[5];m=r,r=s,l=n,n=o,y="compare",document.title="Bus service "+b+" and "+q+" - "+x}else m&&(r=m,m=void 0),l&&(n=l,l=void 0),y="services",document.title="Bus service "+b+" - "+x,c||(c=1);return $busServices.find("a.selected").removeClass("selected"),$("#service-"+b).addClass("selected"),i||t(),$busServicesSection=$("#bus-services-section").addClass("loading"),g("busService-"+b,{no:b},function(g,k){if($busServicesSection.removeClass("loading"),k){var l=k[c],m=l.route,o=l.stops,s=[];
if(m&&m.length){for(var t=0,x=m.length;x>t;t++){var y=m[t],z=y.split(","),A=new google.maps.LatLng(parseFloat(z[0],10),parseFloat(z[1],10));s.push(A)}r.setPath(s),r.setMap(h)}var B='<div class="tab-bar">';k[2]&&k[2].route&&k[2].route.length&&(B+='<a href="#'+(1==c?a:p)+'" class="tab '+(1==c?"selected":"")+'">Route 1</a><a href="#'+(2==c?a:p)+'" class="tab '+(2==c?"selected":"")+'">Route 2</a>'),B+=i?'<a href="">Home</a>':'<a href="#/compare/'+b+"/"+c+'">Compare</a>';var C=busServicesMap[b].operator;
if(C){var D="sbs"==C?"http://www.sbstransit.com.sg/journeyplan/servicedetails.aspx?serviceno=":"http://www.transitlink.com.sg/eservice/eguide/service_route.php?service=";B+='<a href="'+D+b+'" target="_blank" class="details"><svg class="icon"><use xlink:href="#list-alt"></use></svg> Bus schedules</a>'}B+="</div>",B+="<ul>";var E=!1,x=o.length;bounds=new google.maps.LatLngBounds,o.forEach(function(a,c){var d=j[a],g=d.name,k=(f[a],e.circle),l=x-1,m="stop";if(0==c){var p=o[l],q=j[p];g==q.name?(E=!0,k=e.dot,
m="stop-dot"):(k=e.a,m="stop-a")}else c==l&&(E?(k=e.dot,m="stop-dot"):(k=e.b,m="stop-b"));if(c==l&&E)n.push(n[0]);else{var r=new google.maps.LatLng(d.lat,d.lng),s=new google.maps.Marker({position:r,map:h,icon:k,title:g,animation:0==c||c==l||i?google.maps.Animation.DROP:null,zIndex:0==c||c==l?5:1});google.maps.event.addListener(s,"click",function(){google.maps.event.trigger(h,"markerClick",{marker:s,stop:a,currentService:b}),w.find("li a.selected").removeClass("selected"),$(".stop-"+a+'[data-index="'+c+'"]').addClass("selected").focus();
}),n.push(s),bounds.extend(r)}B+='<li><a tabindex="0" href="#" class="'+m+" stop-"+a+'" data-index="'+c+'"><i></i><span class="tag">'+a+"</span> "+g+"</a></li>"}),i&&bounds.union(d),w.html(B+"</ul>"),w[0].scrollTop=0,$("#bus-routes-section h1 b").text(b),i&&(document.getElementsByClassName("back")[0].href="#/compare/"+q+"/"+u),$("section.extra").addClass("hidden"),$("#bus-routes-section").removeClass("hidden"),b==v&&bounds.contains(h.getCenter())||(v=b,h.panTo(bounds.getCenter()),setTimeout(function(){
h.fitBounds(bounds)},400)),lscache.set("busService-"+b,k,1440)}}),bounds};ruto.config({notfound:function(){ruto.go("/")}}).add("/",function(){y="home",document.title=x,$("section.extra").addClass("hidden"),$("body").removeClass("header-collapsed"),t(),setTimeout(function(){$busServices.find("a.selected").removeClass("selected")},400)}).add(/^\/services\/(\w+)\/?(\d)?$/i,function(a,b,c){z(a,b,c)}).add(/^\/compare\/(\w+)\/(\d)$/i,function(a,b,c){z(a,b,c),$("#bus-routes-section").addClass("hidden");var e=i(d,a.slice("/compare".length,1/0));
busServicesMap=e[0],$busServices=e[1]}).add(/^\/compare\/(\w+)\/(\d)\/(\w+)\/(\d)$/i,function(a,b,c,d,e){boundsOld=z(a,d,e),z(a,b,c,boundsOld)}).add(/^\/stops\/(\w+)$/i,function(a,b){y="stops",document.title="Bus stop "+b+" - "+x,t(),$("#bus-stop-routes-section").removeClass("hidden").addClass("loading").find("h1 b").text(b);var c=j[b],d=new google.maps.LatLng(c.lat,c.lng),i=new google.maps.Marker({position:d,map:h,icon:e.dot,title:c.name,animation:google.maps.Animation.DROP});google.maps.event.addListener(i,"click",function(){
google.maps.event.trigger(h,"markerClick",{marker:i,stop:b,hideShowRoutesLink:!0})}),n.push(i);var k=f[b],l=new google.maps.LatLngBounds,m="",o=function(a,c){var d=a[1],e=d.stops;-1!=e.indexOf(b)&&e[e.length-1]!=b||(d=a[2],e=d.stops,-1==e.indexOf(b)&&(d=a[1],e=d.stops)),e.forEach(function(a){var b=j[a];l.extend(new google.maps.LatLng(b.lat,b.lng))});var f=d.route;if(f){for(var g=[],i=0,k=f.length;k>i;i++){var n=f[i],o=n.split(","),q=new google.maps.LatLng(parseFloat(o[0],10),parseFloat(o[1],10));g.push(q);
}var r=new google.maps.Polyline({strokeColor:"#f01b48",strokeWeight:5,strokeOpacity:.4,path:g,map:h});google.maps.event.addListener(r,"mouseover",function(){$("#stop-service-"+c).trigger("mouseover").focus()}),google.maps.event.addListener(r,"mouseout",function(){$("#stop-service-"+c).trigger("mouseout").blur()}),google.maps.event.addListener(r,"click",function(){location.href=$("#stop-service-"+c).attr("href")}),p[c]=r,m+='<li><a href="#/services/'+c+'" id="stop-service-'+c+'"><span class="tag">'+c+"</span> "+busServicesMap[c].name+"</a></li>";
}},q=queue();k.forEach(function(a){q.defer(function(b){g("busService-"+a,{no:a},function(c,d){o(d,a),b()})})}),q.awaitAll(function(){h.fitBounds(l),$("#bus-stop-routes-section").removeClass("loading"),$("#bus-stop-routes").html("<ul>"+m+"</ul>")})}).init(),$("#bus-routes").on("click","li a",function(a){a.preventDefault();var b=$(this).data("index"),c=n[b];if(c){var d=c.getPosition();h.getZoom()<15&&h.setZoom(15),h.panTo(d),google.maps.event.trigger(c,"click")}}),$("#bus-stop-routes").on("mouseover touchstart","li a",function(){
var a=$(this).find(".tag").text();for(var b in p){var c=p[b];b==a?c.setOptions({strokeOpacity:.8}):c.setOptions({strokeOpacity:.1})}}).on("mouseout touchend touchcancel","li a",function(){for(var a in p)p[a].setOptions({strokeOpacity:.4})}),$(document).on("keyup",function(a){if(/services\/.+/i.test(location.hash)&&(!a.target.tagName||"input"!=a.target.tagName.toLowerCase())){var b=a.keyCode;switch(b){case 39:case 40:var c=w.find("li a.selected");if(!c.length)return;c.removeClass("selected");var d=c.parent().next();
if(!d.length)return;d.find("a").trigger("click");break;case 37:case 38:var c=w.find("li a.selected");if(!c.length)return;c.removeClass("selected");var e=c.parent().prev();if(!e.length)return;e.find("a").trigger("click")}}}),$("#sidebar").on("click",function(a){var b=a.target,c=b.tagName.toLowerCase();("h1"==c||"b"==c&&"h1"==b.parentNode.tagName.toLowerCase())&&(a.preventDefault(),$("body").toggleClass("sidebar-collapsed"),setTimeout(function(){google.maps.event.trigger(h,"resize")},300))})},k=queue();
h.forEach(function(a){k.defer(a)}),k.awaitAll(j),$("#heading").on("click",function(){$("#about").addClass("show")}),$("#header-search").on("click",function(){$("#search").addClass("show"),$("#places-search-form input").focus()}),$("#about .close").on("click",function(){lscache.set("busrouter-intro",!0),$("#about").removeClass("show")}),$("#search .close").on("click",function(){$("#search").removeClass("show")}),$("#map").on("click","a.show-arrivals",function(a){a.preventDefault();var b=320,c=480,d=((screen.availHeight||screen.height)-c)/2,e=(screen.width-b)/2;
window.open(this.href,"busArrivals"+new Date,"width="+b+",height="+c+",menubar=0,toolbar=0,top="+d+",left="+e)})}}();
//# sourceMappingURL=scripts.js.map